====================================================================================================================
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
        ► Installer un environnement de développement doker
<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
====================================================================================================================

C'est un excellent choix. **Docker** est l'environnement le plus puissant et flexible pour le développement PHP moderne.

Puisque vous êtes sous **Windows 11**, l'installation et la configuration reposent sur le **Sous-système Windows pour Linux (WSL 2)** pour garantir les meilleures performances.

Voici le guide d'installation en deux phases (Installation de l'outil, puis Configuration du projet PHP/MySQL) :

-----

## PHASE 1 : Installation de Docker Desktop (Prérequis)

Cette étape est la plus technique, mais elle est cruciale pour que Docker fonctionne bien sous Windows.

### Étape 1 : Installer WSL 2 (Si ce n'est pas déjà fait)

1.  **Ouvrez le Terminal Windows** (ou PowerShell) **en mode Administrateur**.
2.  Exécutez cette commande pour installer WSL et la distribution Linux par défaut (Ubuntu) :
    ```bash
    wsl --install
    ```
3.  **Redémarrez votre PC** lorsque le processus est terminé.
4.  Après le redémarrage, une fenêtre de console Ubuntu s'ouvrira. Suivez les instructions pour créer un nom d'utilisateur et un mot de passe Linux (ceux-ci n'affectent pas votre compte Windows).

### Étape 2 : Installer Docker Desktop

1.  **Téléchargez** l'installateur de [Docker Desktop pour Windows](https://www.docker.com/products/docker-desktop).
2.  **Exécutez l'installateur** et suivez les instructions.
3.  Assurez-vous que l'option **"Use WSL 2 instead of Hyper-V (recommended)"** est cochée pendant l'installation.
4.  Une fois l'installation terminée, **lancez Docker Desktop**. L'application peut prendre quelques minutes pour démarrer la première fois. Vérifiez que le voyant dans le coin inférieur gauche (ou dans la barre des tâches) est **vert** pour confirmer qu'il est en cours d'exécution.

-----

## PHASE 2 : Création de l'Environnement PHP 8.2 & MySQL 8.0

Maintenant que Docker est installé, nous allons créer l'environnement PHP et MySQL avec un seul fichier de configuration appelé `docker-compose.yml`.

### Étape 3 : Structurer votre Projet

Créez un dossier pour votre projet, par exemple `SCNPHPApp_Docker`.

À l'intérieur de ce dossier, créez deux éléments :

1.  Un dossier nommé **`app`** (ce sera le dossier où vous mettrez tous vos fichiers PHP, y compris votre `index.php`).
2.  Un fichier nommé **`docker-compose.yml`** (assurez-vous que l'extension est bien `.yml` et non `.txt`).

Votre structure de base devrait ressembler à ceci :

```
SCNPHPApp_Docker/
├── app/
│   └── index.php (Votre code PHP ira ici)
└── docker-compose.yml
```

### Étape 4 : Remplir le Fichier `docker-compose.yml`

Copiez le contenu suivant dans votre fichier `docker-compose.yml`. Il définit les deux conteneurs (services) : `db` et `web`.

```yaml
version: '3.8'

services:

  # 1. SERVICE DE BASE DE DONNÉES (MySQL 8.0)
  db:
    image: mysql:8.0
    container_name: scn_mysql
    restart: always # Redémarre automatiquement
    environment:
      # !! MODIFIEZ CES VALEURS POUR LA PRODUCTION, mais conservez-les ici pour le local !!
      MYSQL_ROOT_PASSWORD: password_root
      MYSQL_DATABASE: scn_db
      MYSQL_USER: user_app
      MYSQL_PASSWORD: password_app
    volumes:
      # Persiste les données de la DB pour qu'elles ne soient pas perdues
      - db-data:/var/lib/mysql 
    ports:
      # Le port 3306 est exposé au PC hôte (pour les outils externes comme DBeaver)
      - "3306:3306" 

  # 2. SERVICE WEB (PHP 8.2 + Apache)
  web:
    image: php:8.2-apache 
    container_name: scn_php_web
    restart: always
    volumes:
      # LIE votre dossier local 'app' au dossier web du conteneur (/var/www/html)
      - ./app:/var/www/html 
    ports:
      # Expose le port 80 du conteneur au port 80 de votre PC (http://localhost)
      - "80:80" 
    depends_on:
      - db # S'assure que la DB est démarrée avant le serveur web

volumes:
  # Définition du volume persistant pour les données de la DB
  db-data:
```

### Étape 5 : Démarrer l'Environnement

1.  **Ouvrez votre terminal Windows** (cmd ou PowerShell) et naviguez jusqu'à votre dossier de projet :
    ```bash
    cd D:\Seb\Programmation\PHP\SCNPHPApp_Docker
    ```
2.  Lancez les conteneurs :
    ```bash
    docker-compose up -d
    ```

**Félicitations \!** Docker va télécharger les images, créer les réseaux et démarrer vos services.

### Étape 6 : Connexion à la Base de Données

Dans votre code PHP (votre classe `MyBDD` ou `PDO`), vous utiliserez les informations de connexion suivantes :

| Paramètre | Valeur Docker |
| :--- | :--- |
| **Hôte (Host)** | **`db`** (C'est le nom du service défini dans `docker-compose.yml`) |
| **Nom d'utilisateur** | `user_app` |
| **Mot de passe** | `password_app` |
| **Nom de la DB** | `scn_db` |

Votre chaîne de connexion PDO sera :
`new PDO("mysql:host=db;dbname=scn_db;charset=utf8", "user_app", "password_app");`

Votre application sera accessible via votre navigateur à l'adresse **`http://localhost`**.

-----

Si vous souhaitez utiliser un outil pour gérer la base de données (comme **PHPMyAdmin** ou **Adminer**), vous pouvez ajouter un troisième service à votre fichier `docker-compose.yml` (je peux vous montrer comment faire si vous le souhaitez).

Vous pouvez arrêter l'environnement à tout moment en tapant `docker-compose down` dans le même dossier.



